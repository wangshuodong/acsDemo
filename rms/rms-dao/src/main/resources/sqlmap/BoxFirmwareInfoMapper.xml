<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cmiot.rms.dao.mapper.BoxFirmwareInfoMapper">
	<resultMap id="BaseResultMap" type="com.cmiot.rms.dao.model.BoxFirmwareInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. -->
		<id column="id" property="id" jdbcType="VARCHAR" />
		<result column="firmware_name" property="firmwareName" jdbcType="VARCHAR" />
		<result column="firmware_version" property="firmwareVersion" jdbcType="VARCHAR" />
		<result column="firmware_path" property="firmwarePath" jdbcType="VARCHAR" />
		<result column="firmware_size" property="firmwareSize" jdbcType="DOUBLE" />
		<result column="firmware_create_time" property="firmwareCreateTime" jdbcType="INTEGER" />
		<result column="firmware_description" property="firmwareDescription" jdbcType="VARCHAR" />
		<result column="factory_code" property="factoryCode" jdbcType="VARCHAR" />
		<result column="factory_name" property="factoryName" jdbcType="VARCHAR" />
		<result column="box_type" property="boxType" jdbcType="VARCHAR" />
		<result column="box_model" property="boxModel" jdbcType="VARCHAR" />
		<result column="device_id" property="deviceId" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. -->
		id, firmware_name, firmware_version, firmware_path, firmware_size, firmware_create_time,
		firmware_description, factory_code, box_type, box_model, device_id
	</sql>

	<select id="selectByDeviceId" resultMap="BaseResultMap">
		SELECT
		a.id id,
		a.firmware_name firmwareName,
		a.firmware_version firmwareVersion,
		a.firmware_path firmwarePath,
		a.firmware_size firmwareSize,
		a.firmware_create_time firmwareCreateTime,
		a.firmware_description firmwareDescription,
		b.factory_code factoryCode,
		a.box_type boxType,
		b.box_model boxModel,
		a.device_id deviceId
		FROM
		t_box_firmware_info a,
		t_box_device_info b
		WHERE
		a.device_id = b.id;
	</select>
	
	<insert id="insertSelective" parameterType="com.cmiot.rms.dao.model.BoxFirmwareInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. -->
		insert into t_box_firmware_info
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="firmwareName != null">
				firmware_name,
			</if>
			<if test="firmwareVersion != null">
				firmware_version,
			</if>
			<if test="firmwarePath != null">
				firmware_path,
			</if>
			<if test="firmwareSize != null">
				firmware_size,
			</if>
			<if test="firmwareCreateTime != null">
				firmware_create_time,
			</if>
			<if test="firmwareDescription != null">
				firmware_description,
			</if>
			<if test="factoryCode != null">
				factory_code,
			</if>
			<if test="boxType != null">
				box_type,
			</if>
			<if test="boxModel != null">
				box_model,
			</if>
			<if test="deviceId != null">
				device_id,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=VARCHAR},
			</if>
			<if test="firmwareName != null">
				#{firmwareName,jdbcType=VARCHAR},
			</if>
			<if test="firmwareVersion != null">
				#{firmwareVersion,jdbcType=VARCHAR},
			</if>
			<if test="firmwarePath != null">
				#{firmwarePath,jdbcType=VARCHAR},
			</if>
			<if test="firmwareSize != null">
				#{firmwareSize,jdbcType=DOUBLE},
			</if>
			<if test="firmwareCreateTime != null">
				#{firmwareCreateTime,jdbcType=INTEGER},
			</if>
			<if test="firmwareDescription != null">
				#{firmwareDescription,jdbcType=VARCHAR},
			</if>
			<if test="factoryCode != null">
				#{factoryCode,jdbcType=VARCHAR},
			</if>
			<if test="boxType != null">
				#{boxType,jdbcType=VARCHAR},
			</if>
			<if test="boxModel != null">
				#{boxModel,jdbcType=VARCHAR},
			</if>
			<if test="deviceId != null">
				#{deviceId,jdbcType=VARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.cmiot.rms.dao.model.BoxFirmwareInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. -->
		update t_box_firmware_info
		<set>
			<if test="firmwareName != null">
				firmware_name = #{firmwareName,jdbcType=VARCHAR},
			</if>
			<if test="firmwareVersion != null">
				firmware_version = #{firmwareVersion,jdbcType=VARCHAR},
			</if>
			<if test="firmwarePath != null and firmwarePath != '' ">
				firmware_path = #{firmwarePath,jdbcType=VARCHAR},
			</if>
			<if test="firmwareSize != null and firmwareSize > 0.0 ">
				firmware_size = #{firmwareSize,jdbcType=DOUBLE},
			</if>
			<if test="firmwareCreateTime != null">
				firmware_create_time = #{firmwareCreateTime,jdbcType=INTEGER},
			</if>
			<if test="firmwareDescription != null">
				firmware_description = #{firmwareDescription,jdbcType=VARCHAR},
			</if>
			<if test="factoryCode != null">
				factory_code = #{factoryCode,jdbcType=VARCHAR},
			</if>
			<if test="boxType != null">
				box_type = #{boxType,jdbcType=VARCHAR},
			</if>
			<if test="boxModel != null">
				box_model = #{boxModel,jdbcType=VARCHAR},
			</if>
			<if test="deviceId != null">
				device_id = #{deviceId,jdbcType=VARCHAR},
			</if>
		</set>
		where id = #{id,jdbcType=VARCHAR}
	</update>

	<select id="queryFirmwareInfo" parameterType="com.cmiot.rms.dao.model.BoxFirmwareInfo" resultMap="BaseResultMap">
		SELECT
		f.id id, 
		f.firmware_name firmwareName, 
		f.firmware_version firmwareVersion, 
		f.firmware_path firmwarePath, 
		f.firmware_size firmwareSize, 
		f.firmware_create_time firmwareCreate_time,
		f.firmware_description firmwareDescription, 
		f.factory_code factoryCode,
		h.factory_name factoryName,
		t.box_model boxModel, 
		f.device_id deviceId 
		FROM
		t_box_firmware_info f,
		t_box_device_info t,
		t_box_factory_info h
		WHERE
		f.device_id = t.id
		AND t.factory_code = h.factory_code
		<if test="id != null ">
			and f.id = #{id,jdbcType=VARCHAR}
		</if>
		<if test="firmwareName != null">
			and f.firmware_name = #{firmwareName,jdbcType=VARCHAR}
		</if>
		<if test="firmwareVersion != null">
			AND f.firmware_version = #{firmwareVersion,jdbcType=VARCHAR}
		</if>
		<if test="factoryCode != null">
			and f.factory_code = #{factoryCode,jdbcType=VARCHAR}
		</if>
		<if test="boxType != null">
			and f.box_type = #{boxType,jdbcType=VARCHAR}
		</if>
		<if test="boxModel != null">
			and t.box_model = #{boxModel,jdbcType=VARCHAR}
		</if>
		<if test="deviceId != null and deviceId !='' ">
			and device_id = #{deviceId,jdbcType=VARCHAR}
		</if>
		ORDER BY firmware_create_time desc

		<!-- select f.*, t.factory_name -->
		<!-- from t_box_firmware_info f, t_box_factory_info t -->
		<!-- WHERE f.factory_code = t.factory_code -->
		<!-- <if test="id != null "> -->
		<!-- and f.id = #{id,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- <if test="firmwareName != null"> -->
		<!-- and f.firmware_name = #{firmwareName,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- <if test="firmwareVersion != null"> -->
		<!-- AND f.firmware_version = #{firmwareVersion,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- <if test="factoryCode != null"> -->
		<!-- and f.factory_code = #{factoryCode,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- <if test="boxType != null"> -->
		<!-- and f.box_type = #{boxType,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- <if test="boxModel != null"> -->
		<!-- and f.box_model = #{boxModel,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- <if test="deviceId != null" > -->
		<!-- and device_id = #{deviceId,jdbcType=VARCHAR} -->
		<!-- </if> -->
		<!-- ORDER BY firmware_create_time desc -->
	</select>

	<select id="selectCount" parameterType="java.util.HashMap" resultType="java.lang.Integer">
		SELECT count(1) FROM t_box_firmware_info
		where 1=1
		<if test="firmwareVersion != null">
			AND firmware_version = #{firmwareVersion,jdbcType=VARCHAR}
		</if>
		<if test="factoryCode != null">
			AND factory_code = #{factoryCode,jdbcType=VARCHAR}
		</if>
		<if test="boxModel != null">
			AND box_model = #{boxModel,jdbcType=VARCHAR}
		</if>
		<if test="id != null ">
			and id != #{id,jdbcType=VARCHAR}
		</if>
		<if test="deviceId != null and deviceId != ''">
			and device_id = #{deviceId,jdbcType=VARCHAR}
		</if>
	</select>

	<select id="queryFirmware" parameterType="com.cmiot.rms.dao.model.BoxFirmwareInfo" resultMap="BaseResultMap">
		select f.*
		from t_box_firmware_info f
		where 1 = 1
		<if test="id != null ">
			and f.id = #{id,jdbcType=VARCHAR}
		</if>
		<if test="firmwareName != null">
			and f.firmware_name = #{firmwareName,jdbcType=VARCHAR}
		</if>
		<if test="firmwareVersion != null">
			AND f.firmware_version = #{firmwareVersion,jdbcType=VARCHAR}
		</if>
		<if test="factoryCode != null">
			and f.factory_code = #{factoryCode,jdbcType=VARCHAR}
		</if>
		<if test="boxType != null">
			and f.box_type = #{boxType,jdbcType=VARCHAR}
		</if>
		<if test="boxModel != null">
			and f.box_model = #{boxModel,jdbcType=VARCHAR}
		</if>
		<if test="deviceId != null">
			and device_id = #{deviceId,jdbcType=VARCHAR}
		</if>
		ORDER BY firmware_create_time desc
	</select>

</mapper>