<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cmiot.rms.dao.mapper.BoxFirmwarePreparedMapper" >
  <resultMap id="BaseResultMap" type="com.cmiot.rms.dao.model.BoxFirmwarePrepared" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <result column="firmware_id" property="firmwareId" jdbcType="VARCHAR" />
    <result column="firmware_previous_id" property="firmwarePreviousId" jdbcType="VARCHAR" />
    <result column="need_force_upgrade" property="needForceUpgrade" jdbcType="BIT" />
  </resultMap>
  <sql id="Base_Column_List" >
    firmware_id, firmware_previous_id, need_force_upgrade
  </sql>
  <insert id="insertSelective" parameterType="com.cmiot.rms.dao.model.BoxFirmwarePrepared" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into t_box_firmware_prepared
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="firmwareId != null" >
        firmware_id,
      </if>
      <if test="firmwarePreviousId != null" >
        firmware_previous_id,
      </if>
      <if test="needForceUpgrade != null" >
        need_force_upgrade,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="firmwareId != null" >
        #{firmwareId,jdbcType=VARCHAR},
      </if>
      <if test="firmwarePreviousId != null" >
        #{firmwarePreviousId,jdbcType=VARCHAR},
      </if>
      <if test="needForceUpgrade != null" >
        #{needForceUpgrade,jdbcType=BIT},
      </if>
    </trim>
  </insert>

  <select id="queryPreparedByFirmwareId" parameterType="java.lang.String" resultType="java.util.HashMap">
    select p.firmware_previous_id id,
       (SELECT f.firmware_version FROM t_box_firmware_info f WHERE f.id = p.firmware_previous_id) firmwareVersion,
       p.need_force_upgrade needForceUpgrade
    from t_box_firmware_prepared p
    WHERE p.firmware_id = #{firmwareId,jdbcType=VARCHAR}
  </select>

  <select id="queryList" parameterType="com.cmiot.rms.dao.model.BoxFirmwarePrepared"
          resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from t_box_firmware_prepared
    where 1=1
    <if test="firmwareId != null">
      and firmware_id =
      #{firmwareId,jdbcType=CHAR}
    </if>
  </select>

  <delete id="deleteByFirmwareId" parameterType="java.lang.String">
    delete from t_box_firmware_prepared
    where firmware_id= #{firmwareId,jdbcType=VARCHAR}
  </delete>

</mapper>