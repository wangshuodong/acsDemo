<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cmiot.rms.dao.mapper.WorkOrderTemplateInfoMapper" >
    <resultMap id="BaseResultMap" type="com.cmiot.rms.dao.model.WorkOrderTemplateInfo" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" property="id" jdbcType="VARCHAR" />
        <result column="template_name" property="templateName" jdbcType="VARCHAR" />
        <result column="template_message" property="templateMessage" jdbcType="VARCHAR" />
        <result column="create_time" property="createTime" jdbcType="VARCHAR" />
    </resultMap>
    <sql id="Base_Column_List" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id, template_name, template_message, create_time
    </sql>
    <insert id="insertSelective" parameterType="com.cmiot.rms.dao.model.WorkOrderTemplateInfo" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into t_work_order_template_info
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="templateName != null" >
                template_name,
            </if>
            <if test="templateMessage != null" >
                template_message,
            </if>
            <if test="createTime != null" >
                create_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="templateName != null" >
                #{templateName,jdbcType=VARCHAR},
            </if>
            <if test="templateMessage != null" >
                #{templateMessage,jdbcType=VARCHAR},
            </if>
            <if test="createTime != null" >
                #{createTime,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.cmiot.rms.dao.model.WorkOrderTemplateInfo" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update t_work_order_template_info
        <set >
            <if test="templateName != null" >
                template_name = #{templateName,jdbcType=VARCHAR},
            </if>
            <if test="templateMessage != null" >
                template_message = #{templateMessage,jdbcType=LONGVARCHAR},
            </if>
            <if test="createTime != null" >
                create_time = #{createTime,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id,jdbcType=VARCHAR}
    </update>

    <select id="selectByParam" parameterType="com.cmiot.rms.dao.model.WorkOrderTemplateInfo" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List" />
        FROM t_work_order_template_info
        WHERE 1=1
        <if test="id != null">
            and id =
            #{id,jdbcType=VARCHAR}
        </if>
        <if test="templateName != null">
            and template_name =
            #{templateName,jdbcType=VARCHAR}
        </if>
        <if test="templateMessage != null">
            and template_message =
            #{templateMessage,jdbcType=LONGVARCHAR}
        </if>
        <if test="createTime != null">
            and create_time =
            #{createTime,jdbcType=VARCHAR}
        </if>
    </select>

    <select id="selectByParamMap" parameterType="java.util.Map" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List" />
        FROM t_work_order_template_info
        WHERE 1=1
        <if test="id != null">
            and id =
            #{id,jdbcType=VARCHAR}
        </if>
        <if test="templateName != null">
            and template_name =
            #{templateName,jdbcType=VARCHAR}
        </if>
        <if test="templateMessage != null">
            and template_message =
            #{templateMessage,jdbcType=LONGVARCHAR}
        </if>
        <if test="createTime != null">
            and create_time =
            #{createTime,jdbcType=VARCHAR}
        </if>
        order by create_time desc
        limit #{start},#{end}
    </select>

    <select id="selectCountByParam" parameterType="java.util.Map" resultType="java.lang.Integer">
        SELECT
        COUNT(id)
        FROM t_work_order_template_info
        WHERE 1=1
        <if test="id != null">
            and id =
            #{id,jdbcType=VARCHAR}
        </if>
        <if test="templateName != null">
            and template_name =
            #{templateName,jdbcType=VARCHAR}
        </if>
        <if test="templateMessage != null">
            and template_message =
            #{templateMessage,jdbcType=LONGVARCHAR}
        </if>
        <if test="createTime != null">
            and create_time =
            #{createTime,jdbcType=VARCHAR}
        </if>
    </select>

    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List" />
        FROM t_work_order_template_info
        WHERE  id =
        #{id,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        DELETE FROM  t_work_order_template_info WHERE  id = #{id,jdbcType=VARCHAR}
    </delete>

    <select id="selectByBusinessCode" parameterType="java.util.HashMap" resultType="java.util.HashMap">
      <!--   SELECT b.BUSINESS_CODE,a.template_message FROM t_work_order_template_info a,t_business_category_info b ,t_business_template_relation c ,t_gateway_info d where
        a.id = c.business_template AND c.bussiness_code = b.BUSINESS_CODE AND c.factoryID = d.gateway_factory_code AND c.firmware_version = d.gateway_version
        AND c.hd_version = d.gateway_hardware_version AND b.BUSINESS_CODE = #{businessCode,jdbcType=VARCHAR} AND d.gateway_macaddress =  #{gatewayMacaddress,jdbcType=VARCHAR}
    	-->
    	SELECT 
		  b.BUSINESS_CODE,
		  a.template_message 
		FROM
		  t_work_order_template_info a,
		  t_business_category_info b,
		  t_business_template_relation c,
		  t_gateway_info d,
		  t_hd_version_info f
		WHERE a.id = c.business_template 
		  AND c.bussiness_code = b.BUSINESS_CODE 
		  AND c.factoryID = d.gateway_factory_code 
		  AND c.firmware_version = d.gateway_firmware_uuid 
		  AND c.hd_version = d.gateway_hardware_version 
		  AND f.device_id = d.gateway_device_uuid AND f.id = c.hd_version
		  AND b.BUSINESS_CODE = #{businessCode,jdbcType=VARCHAR} AND d.gateway_macaddress =  #{gatewayMacaddress,jdbcType=VARCHAR} 
		    
    </select>

    <select id="selectDefaultTemplate" parameterType="java.util.HashMap" resultType="java.util.HashMap">
        SELECT b.BUSINESS_CODE,a.template_message FROM t_work_order_template_info a,t_business_category_info b ,t_business_template_relation c where
        a.id = c.business_template AND c.bussiness_code = b.BUSINESS_CODE AND c.is_ig = '0' AND b.BUSINESS_CODE = #{businessCode,jdbcType=VARCHAR}
    </select>
</mapper>